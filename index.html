<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



    <link href="./dist/places-autocomplete.css" rel="stylesheet">
    <!-- <link href="./places-autocomplete.css" rel="stylesheet"> -->

    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/places-autocomplete-js@latest/dist/places-autocomplete.css"> -->


    <script type="module">
        // import { PlacesAutocomplete } from './PlacesAutocomplete.js';
        import { PlacesAutocomplete } from './dist/places-autocomplete.js';
        //import './dist/places-autocomplete.css';
        // import { PlacesAutocomplete } from 'https://cdn.jsdelivr.net/npm/places-autocomplete-js@latest/dist/places-autocomplete.js';
        // import 'https://cdn.jsdelivr.net/npm/places-autocomplete-js@latest/dist/places-autocomplete.css';


        document.addEventListener('DOMContentLoaded', () => {
            try {
                const myPac = new PlacesAutocomplete({
                    containerId: 'my-pac-container',
                    googleMapsApiKey: import.meta.env.VITE_GOOGLE_MAPS_API_KEY, // Replace with your Google Maps API key
                    onResponse: (placeDetails) => {
                        console.log('Place selected from module:', placeDetails);
                        let rspContainer = document.getElementById('response-container');
                        rspContainer.classList.remove('hidden');
                        rspContainer.classList.add('block');
                        let responseMessage = document.getElementById('response-message');
                        responseMessage.innerHTML = JSON.stringify(placeDetails, null, 4);

                    },
                    onError: (error) => {
                        console.error('Error from module:', error.message);
                    },
                    options: { // Optional: Override default options
                        placeholder: 'Start typing your address...',
                        label: 'Search for an address',
                        // debounce: 100,
                        clear_input: false, // Show clear button
                        show_place_type: true, // Show place type in suggestions
                        distance: false, // Show distance to each suggestion (mutually exclusive with show_place_type

                        // classes: { // Override specific classes
                        //     input:
                        //         "border-1 w-full rounded-md border-0 shadow-sm bg-gray-100 px-4 py-2.5 pl-10 pr-20 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 sm:text-sm",

                        // }
                    },
                    requestParams: { // Optional: Override default request parameters
                        input: '', // The user's input text. Will be updated dynamically.
                        // includedRegionCodes: ['GB'], // Restrict search to Great Britain.
                        // language: 'en-gb', // Preferred language for results.
                        // region: 'GB', // Region biasing (GB).
                        // origin: {
                        //     lat: 53.76538654312942,
                        //     lng: -3.0181503295898438
                        // },
                        // locationBias: {
                        //     lat: 53.39670653190076,
                        //     lng: -2.9346197562747967,
                        //     radius: 50000 // 50km radius


                        // }
                    },
                    fetchFields: ["formattedAddress", "addressComponents"], // Optional: Specify which fields to fetch
                });

                //console.log('PlacesAutocomplete instance created:', myPac.getOptions());

                const btnClear = document.getElementById('btnClear');
                const btnDestroy = document.getElementById('btnDestroy');
                const btnFocus = document.getElementById('btnFocus');
                const btnGetFetchFields = document.getElementById('btnGetFetchFields');
                const btnGetOptions = document.getElementById('btnGetOptions');
                const btnGetRequestParams = document.getElementById('btnGetRequestParams');
                const btnSetInputValue = document.getElementById('btnSetInputValue');
                const btnTogglePlaceType = document.getElementById('btnTogglePlaceType');

                btnClear.addEventListener('click', () => {
                    myPac.clear();
                    console.log('Cleared');
                });

                btnDestroy.addEventListener('click', () => {
                    myPac.destroy();
                    console.log('Destroyed');
                });

                btnFocus.addEventListener('click', () => {
                    myPac.focus();
                    console.log('Focused');
                });

                btnGetFetchFields.addEventListener('click', () => {
                    console.log('Current Fetch Fields:', myPac.getFetchFields());
                });

                btnGetOptions.addEventListener('click', () => {
                    console.log('Current Options:', myPac.getOptions());
                });

                btnGetRequestParams.addEventListener('click', () => {
                    console.log('Current Request Params:', myPac.getRequestParams());
                });

                btnSetInputValue.addEventListener('click', () => {
                    // Eiffel Tower coordinates
                    myPac.setInputValue(48.8584, 2.2945);
                    console.log('Set Input Value to Eiffel Tower');
                });

                btnTogglePlaceType.addEventListener('click', () => {
                    const currentOptions = myPac.getOptions();
                    const newShowPlaceType = !currentOptions.show_place_type;
                    myPac.setOptions({
                        show_place_type: newShowPlaceType,
                        distance: !newShowPlaceType // They are mutually exclusive
                    });
                    console.log('Show Place Type toggled to:', newShowPlaceType);
                });

                const btnSetParams = document.getElementById('btnSetParams');
                btnSetParams.addEventListener('click', () => {
                    myPac.setRequestParams({
                        region: 'FR',
                        language: 'fr'
                    });
                    console.log('Request Params set to FR/fr');
                });

                const btnSetFields = document.getElementById('btnSetFields');
                btnSetFields.addEventListener('click', () => {
                    myPac.setFetchFields(['photos', 'rating', 'userRatingCount']);
                    console.log('Fetch Fields set to include photos and ratings');
                });


            } catch (error) {
                console.error("Failed to initialize PAC:", error.message);
                console.error("Error details:", error);
            }
        });
    </script>
</head>

<body>





    <div style="width:850px; margin:0 auto;">

        <div id="my-pac-container"></div>


        <div class="flex flex-wrap items-center mt-10 gap-4" style="margin-top:2rem">
            <button type="button" id="btnClear"
                class="rounded-md bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50">Clear</button>

            <button type="button" id="btnFocus"
                class="rounded-md bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50">Focus</button>

            <button type="button" id="btnGetFetchFields"
                class="rounded-md bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50">Get
                Fields</button>

            <button type="button" id="btnSetFields"
                class="rounded-md bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50">Set
                Fields</button>

            <button type="button" id="btnGetOptions"
                class="rounded-md bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50">Get
                Options</button>

            <button type="button" id="btnGetRequestParams"
                class="rounded-md bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50">Get
                Params</button>

            <button type="button" id="btnSetParams"
                class="rounded-md bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50">Set
                Params</button>

            <button type="button" id="btnSetInputValue"
                class="rounded-md bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50">Set
                Value (Eiffel)</button>

            <button type="button" id="btnTogglePlaceType"
                class="rounded-md bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50">Toggle
                Place Type</button>

            <button type="button" id="btnDestroy"
                class="rounded-md bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50">Destroy</button>
        </div>


        <div class="rounded-md bg-gray-100 mt-4 p-4 hidden" id="response-container">

            <pre class="">
                <code id="response-message" class="text-sm font-mono"></code>
            </pre>

        </div>
    </div>

    </div>


</body>

</html>